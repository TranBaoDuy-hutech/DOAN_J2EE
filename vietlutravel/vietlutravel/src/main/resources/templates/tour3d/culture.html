<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Văn Hóa 360° — An Giang</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum/build/pannellum.css"/>
    <script src="https://cdn.jsdelivr.net/npm/pannellum/build/pannellum.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;0,700;1,300;1,400&family=Rajdhani:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --gold: #c9a84c;
            --gold-glow: rgba(201,168,76,0.18);
            --teal: #2a9d8f;
            --teal-glow: rgba(42,157,143,0.2);
            --deep: #04060d;
            --dark1: #080b16;
            --dark2: #0e1220;
            --dark3: #141828;
            --glass: rgba(255,255,255,0.035);
            --glass-border: rgba(255,255,255,0.07);
            --text: #f0ead8;
            --text-dim: rgba(240,234,216,0.5);
        }

        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: var(--deep);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            cursor: none;
        }

        /* ─── CURSOR ─── */
        #cur { position: fixed; width: 7px; height: 7px; background: var(--gold); border-radius: 50%; pointer-events: none; z-index: 9999; transition: transform 0.1s; mix-blend-mode: difference; }
        #curR { position: fixed; width: 28px; height: 28px; border: 1px solid rgba(201,168,76,0.5); border-radius: 50%; pointer-events: none; z-index: 9998; transition: all 0.14s ease; }

        /* ─── BG CANVAS ─── */
        #bgc { position: fixed; inset: 0; z-index: 0; opacity: 0.55; pointer-events: none; }
        body::after {
            content: ''; position: fixed; inset: 0; z-index: 1; pointer-events: none;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
            opacity: 0.025;
        }

        .page { position: relative; z-index: 2; }

        /* ─── NAVBAR ─── */
        .navbar {
            display: flex; align-items: center; justify-content: space-between;
            padding: 14px 70px;
            border-bottom: 1px solid var(--glass-border);
            background: rgba(4,6,13,0.85);
            backdrop-filter: blur(20px);
            position: sticky; top: 0; z-index: 100;
        }
        .nav-logo {
            font-family: 'Space Mono', monospace; font-size: 0.6rem;
            letter-spacing: 4px; color: var(--gold); text-decoration: none;
            text-transform: uppercase;
        }
        .nav-links { display: flex; }
        .nav-link {
            font-family: 'Rajdhani', sans-serif; font-size: 0.8rem;
            letter-spacing: 2px; color: var(--text-dim); text-decoration: none;
            text-transform: uppercase; padding: 8px 18px;
            border-bottom: 2px solid transparent; transition: all 0.3s;
        }
        .nav-link:hover { color: var(--text); }
        .nav-link.active { color: var(--gold); border-bottom-color: var(--gold); }

        /* ─── MARQUEE ─── */
        .marquee { overflow: hidden; border-bottom: 1px solid var(--glass-border); padding: 14px 0; }
        .marquee-track { display: flex; gap: 50px; width: max-content; animation: marquee 30s linear infinite; }
        .marquee-item {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.05rem; font-style: italic; font-weight: 300;
            color: var(--text-dim); white-space: nowrap;
            display: flex; align-items: center; gap: 24px;
        }
        .m-sep { width: 4px; height: 4px; background: var(--teal); border-radius: 50%; flex-shrink: 0; }
        @keyframes marquee { from { transform: translateX(0); } to { transform: translateX(-50%); } }

        /* ─── HEADER ─── */
        .header { padding: 44px 70px 0; display: flex; align-items: flex-end; justify-content: space-between; gap: 40px; }
        .header-eyebrow {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem; letter-spacing: 5px; color: var(--gold);
            text-transform: uppercase; display: flex; align-items: center; gap: 12px; margin-bottom: 14px;
        }
        .header-eyebrow::before { content: ''; width: 28px; height: 1px; background: var(--gold); opacity: 0.6; }
        .header-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: clamp(2.8rem, 6vw, 5.5rem); font-weight: 300;
            line-height: 0.95; letter-spacing: -1px;
        }
        .header-title em { font-style: italic; color: var(--gold); }
        .header-title .outline { -webkit-text-stroke: 1px rgba(240,234,216,0.28); color: transparent; }
        .header-right { text-align: right; flex-shrink: 0; }
        .header-desc { font-size: 0.95rem; line-height: 1.8; color: var(--text-dim); font-weight: 300; max-width: 320px; margin-bottom: 20px; }
        .header-badges { display: flex; gap: 10px; justify-content: flex-end; flex-wrap: wrap; }
        .hbadge {
            display: inline-flex; align-items: center; gap: 8px;
            border: 1px solid var(--glass-border); padding: 8px 16px;
            font-family: 'Space Mono', monospace; font-size: 0.55rem;
            letter-spacing: 3px; color: var(--text-dim); text-transform: uppercase;
        }
        .dot-teal { width: 6px; height: 6px; background: var(--teal); border-radius: 50%; animation: blink 2s infinite; }
        .dot-gold { width: 6px; height: 6px; background: var(--gold); border-radius: 50%; animation: blink 2s 0.5s infinite; }
        @keyframes blink { 0%,100% { opacity:1; } 50% { opacity:0.2; } }
        .header-link { text-decoration: none; color: inherit; display: inline-block; }

        .h-div {
            height: 1px;
            background: linear-gradient(to right, transparent, var(--glass-border) 20%, var(--glass-border) 80%, transparent);
            margin: 40px 70px 0;
        }

        /* ─── PANORAMA SECTION ─── */
        .pano-section { padding: 50px 70px 0; max-width: 1600px; margin: 0 auto; }
        .section-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem; letter-spacing: 5px; color: var(--gold);
            text-transform: uppercase; display: flex; align-items: center; gap: 14px; margin-bottom: 20px;
        }
        .section-label::after { content: ''; flex: 1; height: 1px; background: var(--glass-border); }
        .section-title { font-family: 'Cormorant Garamond', serif; font-size: clamp(1.8rem, 3.5vw, 3rem); font-weight: 300; margin-bottom: 28px; }
        .section-title em { font-style: italic; color: var(--gold); }

        .pano-wrap { position: relative; border: 1px solid var(--glass-border); overflow: hidden; }
        .pano-wrap::after {
            content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 5;
            background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.015) 2px, rgba(0,0,0,0.015) 4px);
        }
        #panorama2 { width: 100%; height: 62vh; min-height: 460px; }

        .pano-hud { position: absolute; top: 20px; left: 20px; z-index: 10; display: flex; flex-direction: column; gap: 8px; }
        .phud-box { background: rgba(4,6,13,0.85); backdrop-filter: blur(16px); border: 1px solid var(--glass-border); padding: 8px 16px; }
        .phud-label { font-family: 'Space Mono', monospace; font-size: 0.5rem; letter-spacing: 3px; color: var(--text-dim); text-transform: uppercase; }
        .phud-val { font-family: 'Cormorant Garamond', serif; font-size: 1rem; font-weight: 600; color: var(--gold); }

        .pano-compass {
            position: absolute; bottom: 28px; right: 28px; z-index: 10;
            width: 64px; height: 64px;
            border: 1px solid rgba(201,168,76,0.2); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            animation: spin360 35s linear infinite;
        }
        .pano-compass::before { content: 'N'; position: absolute; top: 7px; font-family: 'Space Mono', monospace; font-size: 0.5rem; color: var(--gold); }
        .pano-compass i { color: rgba(201,168,76,0.35); font-size: 1.1rem; }
        @keyframes spin360 { from { transform: rotate(0); } to { transform: rotate(360deg); } }

        /* ─── FILTER BAR ─── */
        .filter-bar { display: flex; align-items: center; gap: 0; border-bottom: 1px solid var(--glass-border); overflow-x: auto; }
        .filter-btn {
            padding: 16px 22px; background: transparent; border: none;
            border-bottom: 2px solid transparent; color: var(--text-dim); cursor: none;
            font-family: 'Rajdhani', sans-serif; font-size: 0.82rem; font-weight: 500;
            letter-spacing: 2px; text-transform: uppercase; transition: all 0.3s;
            white-space: nowrap; margin-bottom: -1px;
        }
        .filter-btn:hover { color: var(--text); }
        .filter-btn.active { color: var(--gold); border-bottom-color: var(--gold); }

        /* ─── GALLERY SECTION ─── */
        .gallery-section { padding: 50px 70px 80px; max-width: 1600px; margin: 0 auto; }
        .gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); gap: 2px; }

        /* ─── CARD — dùng thẻ <a> ─── */
        .card {
            position: relative; background: var(--dark1);
            overflow: hidden; cursor: none;
            display: flex; flex-direction: column;
            opacity: 0; transform: translateY(28px);
            text-decoration: none; color: inherit;
        }
        .card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0;
            height: 1px; background: linear-gradient(to right, transparent, var(--gold), transparent);
            transform: scaleX(0); transition: transform 0.5s cubic-bezier(0.4,0,0.2,1); z-index: 10;
        }
        .card:hover::before { transform: scaleX(1); }
        .card:hover { background: var(--dark2); }

        /* Arrow indicator */
        .card-arrow {
            position: absolute; bottom: 16px; right: 16px; z-index: 10;
            width: 32px; height: 32px;
            border: 1px solid rgba(201,168,76,0.3); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            color: var(--gold); font-size: 0.75rem;
            opacity: 0; transform: translateX(-4px); transition: all 0.3s 0.1s;
        }
        .card:hover .card-arrow { opacity: 1; transform: translateX(0); }

        .thumb-wrap { position: relative; overflow: hidden; height: 220px; flex-shrink: 0; }
        .thumbnail {
            width: 100%; height: 100%; object-fit: cover;
            transition: transform 0.7s cubic-bezier(0.25,0.46,0.45,0.94), filter 0.5s;
            filter: brightness(0.65) saturate(0.8);
        }
        .card:hover .thumbnail { transform: scale(1.07); filter: brightness(0.8) saturate(1.1); }
        .thumb-overlay { position: absolute; inset: 0; background: linear-gradient(to top, rgba(4,6,13,0.9) 0%, transparent 55%); }

        .card-num {
            position: absolute; top: 16px; left: 18px;
            font-family: 'Space Mono', monospace; font-size: 0.5rem;
            letter-spacing: 2px; color: rgba(201,168,76,0.5); z-index: 5; transition: color 0.3s;
        }
        .card:hover .card-num { color: var(--gold); }

        .card-cat-badge {
            position: absolute; top: 14px; right: 14px;
            background: rgba(4,6,13,0.85); backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border); padding: 5px 10px;
            font-family: 'Space Mono', monospace; font-size: 0.48rem;
            letter-spacing: 2px; color: var(--text-dim); text-transform: uppercase; z-index: 5;
            opacity: 0; transform: translateY(-4px); transition: all 0.3s 0.1s;
        }
        .card:hover .card-cat-badge { opacity: 1; transform: translateY(0); }

        .info { padding: 22px 24px 18px; border-top: 1px solid var(--glass-border); }
        .info-tag {
            font-family: 'Space Mono', monospace; font-size: 0.5rem;
            letter-spacing: 3px; color: var(--teal); text-transform: uppercase;
            margin-bottom: 8px; opacity: 0; transform: translateY(4px); transition: all 0.4s;
        }
        .card:hover .info-tag { opacity: 1; transform: translateY(0); }
        .info h4 {
            font-family: 'Cormorant Garamond', serif; font-size: 1.4rem;
            font-weight: 600; color: var(--text); margin-bottom: 8px; line-height: 1.2; transition: color 0.3s;
        }
        .card:hover .info h4 { color: var(--gold); }
        .info p {
            font-size: 0.88rem; color: var(--text-dim); font-weight: 300; line-height: 1.7;
            max-height: 0; overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.4,0,0.2,1), opacity 0.4s; opacity: 0;
        }
        .card:hover .info p { max-height: 80px; opacity: 1; }

        /* Video — click video chỉ play, không navigate */
        .video-wrap { position: relative; flex: 1; border-top: 1px solid var(--glass-border); }
        .video-frame { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; background: #000; }
        .video-frame iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }

        .video-shield {
            position: absolute; inset: 0; z-index: 5; cursor: none;
            background: linear-gradient(to bottom, transparent 60%, rgba(4,6,13,0.7));
            display: flex; align-items: center; justify-content: center; transition: opacity 0.4s;
        }
        .play-btn {
            width: 56px; height: 56px;
            border: 1px solid rgba(201,168,76,0.6); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            color: var(--gold); font-size: 1.2rem; background: rgba(4,6,13,0.75);
            backdrop-filter: blur(10px); transition: all 0.3s; padding-left: 3px;
        }
        .video-shield:hover .play-btn { background: var(--gold); color: var(--deep); border-color: var(--gold); }
        .video-shield.active { opacity: 0; pointer-events: none; }

        /* ─── FOOTER ─── */
        footer {
            padding: 40px 70px; border-top: 1px solid var(--glass-border);
            display: flex; justify-content: space-between; align-items: center;
        }
        .footer-logo { font-family: 'Cormorant Garamond', serif; font-size: 1.4rem; font-weight: 300; letter-spacing: 4px; color: var(--gold); }
        .footer-copy { font-family: 'Space Mono', monospace; font-size: 0.55rem; letter-spacing: 2px; color: var(--text-dim); }

        /* ─── RESPONSIVE ─── */
        @media (max-width: 900px) {
            .navbar { padding: 12px 20px; }
            .header { padding: 28px 24px 0; flex-direction: column; align-items: flex-start; gap: 24px; }
            .header-right { text-align: left; }
            .h-div { margin: 28px 24px 0; }
            .pano-section { padding: 40px 24px 0; }
            .gallery-section { padding: 32px 24px 60px; }
            .gallery { grid-template-columns: 1fr; }
            footer { padding: 30px 24px; flex-direction: column; gap: 12px; text-align: center; }
            .pano-hud { display: none; }
        }
        @media (max-width: 600px) {
            #panorama2 { height: 50vh; min-height: 340px; }
            .thumb-wrap { height: 180px; }
        }
    </style>
</head>
<body>

<div id="cur"></div>
<div id="curR"></div>
<canvas id="bgc"></canvas>

<div class="page">

    <!-- Navbar -->
    <nav class="navbar">
        <a th:href="@{/tour3d}" class="nav-logo">← AN GIANG 3D</a>
        <div class="nav-links">
            <a th:href="@{/tour3d/tour}"    class="nav-link">Tour 360°</a>
            <a th:href="@{/tour3d/food}"    class="nav-link">Ẩm thực</a>
            <a th:href="@{/tour3d/culture}" class="nav-link active">Văn hóa</a>
        </div>
    </nav>

    <!-- Marquee -->
    <div class="marquee">
        <div class="marquee-track">
            <span class="marquee-item">Lễ hội Vía Bà <span class="m-sep"></span></span>
            <span class="marquee-item">Đua Bò Bảy Núi <span class="m-sep"></span></span>
            <span class="marquee-item">Đờn Ca Tài Tử <span class="m-sep"></span></span>
            <span class="marquee-item">Làng Chăm Châu Phong <span class="m-sep"></span></span>
            <span class="marquee-item">Ok Om Bok <span class="m-sep"></span></span>
            <span class="marquee-item">Chùa Khmer <span class="m-sep"></span></span>
            <span class="marquee-item">Chợ Nổi Long Xuyên <span class="m-sep"></span></span>
            <span class="marquee-item">Dệt Thổ Cẩm <span class="m-sep"></span></span>
            <span class="marquee-item">Lễ hội Vía Bà <span class="m-sep"></span></span>
            <span class="marquee-item">Đua Bò Bảy Núi <span class="m-sep"></span></span>
            <span class="marquee-item">Đờn Ca Tài Tử <span class="m-sep"></span></span>
            <span class="marquee-item">Làng Chăm Châu Phong <span class="m-sep"></span></span>
            <span class="marquee-item">Ok Om Bok <span class="m-sep"></span></span>
            <span class="marquee-item">Chùa Khmer <span class="m-sep"></span></span>
            <span class="marquee-item">Chợ Nổi Long Xuyên <span class="m-sep"></span></span>
            <span class="marquee-item">Dệt Thổ Cẩm <span class="m-sep"></span></span>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="header-eyebrow">Văn hóa · Lễ hội · Di sản</div>
            <a th:href="@{/tour3d}" class="header-link" title="Về trang chủ Tour 3D">
                <h1 class="header-title">
                    Văn <em>Hóa</em><br>
                    <span class="outline">An Giang</span>
                </h1>
            </a>
        </div>
        <div class="header-right">
            <p class="header-desc">
                Khám phá kho tàng văn hóa đa dân tộc — Kinh, Khmer, Chăm, Hoa —
                qua ảnh 360° và những thước phim tư liệu quý giá.
            </p>
            <div class="header-badges">
                <div class="hbadge">
                    <div class="dot-teal"></div>
                    <span th:text="${danhSachVanHoa != null ? danhSachVanHoa.size() + ' Chủ đề' : '17 Chủ đề'}">17 Chủ đề</span>
                </div>
                <div class="hbadge"><div class="dot-gold"></div>360° · Video</div>
            </div>
        </div>
    </header>

    <div class="h-div"></div>

    <!-- Panorama -->
    <section class="pano-section">
        <div class="section-label">01 — Khám Phá 360°</div>
        <h2 class="section-title">Toàn cảnh <em>văn hóa</em></h2>
        <div class="pano-wrap">
            <div class="pano-hud">
                <div class="phud-box">
                    <div class="phud-label">Chế độ xem</div>
                    <div class="phud-val">360° Panorama</div>
                </div>
                <div class="phud-box">
                    <div class="phud-label">Tỉnh</div>
                    <div class="phud-val">An Giang</div>
                </div>
            </div>
            <div id="panorama2"></div>
            <div class="pano-compass">
                <i class="bi bi-compass"></i>
            </div>
        </div>
    </section>

    <!-- Gallery Section -->
    <section class="gallery-section">
        <div class="section-label">02 — Văn Hóa &amp; Lễ Hội</div>
        <h2 class="section-title" style="margin-bottom:28px;">Khám phá từng <em>chủ đề</em></h2>

        <!-- Filter -->
        <div class="filter-bar" style="margin-bottom: 32px;">
            <button class="filter-btn active" data-filter="all">Tất cả</button>
            <button class="filter-btn" data-filter="lehoi">Lễ hội</button>
            <button class="filter-btn" data-filter="nghethuat">Nghệ thuật</button>
            <button class="filter-btn" data-filter="langnghe">Làng nghề</button>
            <button class="filter-btn" data-filter="sonnuoc">Sông nước</button>
            <button class="filter-btn" data-filter="dantoc">Dân tộc</button>
        </div>

        <!-- Gallery — <a> thay <div> để click vào detail -->
        <div class="gallery" id="gallery">

            <a th:each="vh, stat : ${danhSachVanHoa}"
               th:href="@{/tour3d/culture/{id}(id=${vh.id})}"
               th:data-cat="${vh.danhMuc}"
               class="card">

                <!-- Thumbnail -->
                <div class="thumb-wrap">
                    <img th:src="${vh.hinhAnh}"
                         th:alt="${vh.tieuDe}"
                         class="thumbnail"
                         onerror="this.src='/image/t1.jpg'">
                    <div class="thumb-overlay"></div>
                    <div class="card-num"
                         th:text="${stat.index + 1 < 10 ? '0' + (stat.index + 1) : '' + (stat.index + 1)}">01</div>
                    <div class="card-cat-badge" th:text="${vh.danhMuc}">Lễ hội</div>
                </div>

                <!-- Info -->
                <div class="info">
                    <div class="info-tag" th:text="${vh.danhMuc}"></div>
                    <h4 th:text="${vh.tieuDe}">Tiêu đề</h4>
                    <p th:text="${vh.moTa}">Mô tả</p>
                </div>

                <!-- Video — click chỉ play, không navigate sang detail -->
                <div class="video-wrap"
                     th:if="${vh.videoUrl != null and !#strings.isEmpty(vh.videoUrl)}"
                     onclick="event.preventDefault()">
                    <div class="video-frame">
                        <iframe th:src="${vh.videoUrl}"
                                th:title="${vh.tieuDe}"
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen
                                loading="lazy"></iframe>
                    </div>
                    <div class="video-shield">
                        <div class="play-btn"><i class="bi bi-play-fill"></i></div>
                    </div>
                </div>

                <!-- Arrow hover -->
                <div class="card-arrow"><i class="bi bi-arrow-right"></i></div>

            </a>

        </div>
    </section>

    <footer>
        <div class="footer-logo">AN GIANG</div>
        <div class="footer-copy">© 2025 Văn Hóa 360° · An Giang Cultural Heritage</div>
    </footer>

</div>

<script>
    // ─── Cursor ───
    const cur = document.getElementById('cur');
    const curR = document.getElementById('curR');
    let mx = 0, my = 0, rx = 0, ry = 0;
    document.addEventListener('mousemove', e => {
        mx = e.clientX; my = e.clientY;
        cur.style.left = (mx - 3.5) + 'px';
        cur.style.top  = (my - 3.5) + 'px';
    });
    (function loop() {
        rx += (mx - rx) * 0.12; ry += (my - ry) * 0.12;
        curR.style.left = (rx - 14) + 'px';
        curR.style.top  = (ry - 14) + 'px';
        requestAnimationFrame(loop);
    })();
    document.querySelectorAll('a, button').forEach(el => {
        el.addEventListener('mouseenter', () => {
            cur.style.transform = 'scale(3)';
            curR.style.transform = 'scale(1.4)';
            curR.style.borderColor = 'rgba(201,168,76,1)';
        });
        el.addEventListener('mouseleave', () => {
            cur.style.transform = 'scale(1)';
            curR.style.transform = 'scale(1)';
            curR.style.borderColor = 'rgba(201,168,76,0.5)';
        });
    });

    // ─── BG Canvas ───
    const c = document.getElementById('bgc');
    const ctx = c.getContext('2d');
    function rsz() { c.width = window.innerWidth; c.height = window.innerHeight; }
    rsz(); window.addEventListener('resize', rsz);
    const pts = Array.from({length: 40}, () => ({
        x: Math.random() * innerWidth, y: Math.random() * innerHeight,
        r: Math.random() * 1.2 + 0.3,
        vx: (Math.random() - .5) * 0.22, vy: (Math.random() - .5) * 0.22,
        o: Math.random() * 0.35 + 0.1
    }));
    function draw() {
        ctx.clearRect(0, 0, c.width, c.height);
        const g1 = ctx.createRadialGradient(c.width*.15, c.height*.25, 0, c.width*.15, c.height*.25, c.width*.5);
        g1.addColorStop(0, 'rgba(42,157,143,0.06)'); g1.addColorStop(1, 'rgba(4,6,13,0)');
        ctx.fillStyle = g1; ctx.fillRect(0, 0, c.width, c.height);
        const g2 = ctx.createRadialGradient(c.width*.85, c.height*.7, 0, c.width*.85, c.height*.7, c.width*.5);
        g2.addColorStop(0, 'rgba(201,168,76,0.05)'); g2.addColorStop(1, 'rgba(4,6,13,0)');
        ctx.fillStyle = g2; ctx.fillRect(0, 0, c.width, c.height);
        pts.forEach((p, i) => {
            p.x += p.vx; p.y += p.vy;
            if (p.x < 0) p.x = c.width;  if (p.x > c.width)  p.x = 0;
            if (p.y < 0) p.y = c.height; if (p.y > c.height) p.y = 0;
            ctx.beginPath(); ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(201,168,76,${p.o})`; ctx.fill();
            for (let j = i + 1; j < pts.length; j++) {
                const q = pts[j], d = Math.hypot(p.x - q.x, p.y - q.y);
                if (d < 100) {
                    ctx.beginPath(); ctx.moveTo(p.x, p.y); ctx.lineTo(q.x, q.y);
                    ctx.strokeStyle = `rgba(42,157,143,${0.03 * (1 - d / 100)})`;
                    ctx.lineWidth = 0.5; ctx.stroke();
                }
            }
        });
        requestAnimationFrame(draw);
    }
    draw();

    // ─── Pannellum ───
    pannellum.viewer('panorama2', {
        type: "equirectangular",
        panorama: "/image/test.jpg",
        autoLoad: true,
        autoRotate: -1.5,
        autoRotateInactivityDelay: 3000,
        showZoomCtrl: false,
        compass: false
    });

    // ─── Filter ───
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            const f = btn.dataset.filter;
            document.querySelectorAll('.card').forEach(card => {
                const show = f === 'all' || card.dataset.cat === f;
                card.style.display = show ? 'flex' : 'none';
            });
        });
    });

    // ─── Video shield — play, không navigate ───
    document.querySelectorAll('.video-shield').forEach(shield => {
        shield.addEventListener('click', e => {
            e.preventDefault();
            shield.classList.add('active');
        });
    });

    // ─── Reveal on scroll ───
    const io = new IntersectionObserver(entries => {
        entries.forEach(e => {
            if (e.isIntersecting) {
                e.target.style.transition = 'opacity 0.7s ease, transform 0.7s ease';
                e.target.style.opacity = '1';
                e.target.style.transform = 'translateY(0)';
                io.unobserve(e.target);
            }
        });
    }, { threshold: 0.06 });

    document.querySelectorAll('.card').forEach((card, i) => {
        card.style.transitionDelay = (i % 3) * 0.08 + 's';
        io.observe(card);
    });
</script>
</body>
</html>